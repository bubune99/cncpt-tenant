{"version":3,"sources":["/mnt/c/Users/bubun/CascadeProjects/cncpt-tenant/packages/cms/dist/chunk-V746VSQL.js","../src/components/admin-chat/chat-panel.tsx","../src/components/ui/textarea.tsx","../src/components/ui/tooltip.tsx","../src/lib/ai/chat-store.ts","../src/hooks/use-chat-context.ts"],"names":["jsx","jsxs"],"mappings":"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","file":"/mnt/c/Users/bubun/CascadeProjects/cncpt-tenant/packages/cms/dist/chunk-V746VSQL.js","sourcesContent":[null,"'use client';\n\n/**\n * Admin Chat Panel\n *\n * A persistent chat panel for the admin dashboard with AI assistant.\n * Uses AI SDK v6 with proper streaming and tool support.\n */\n\nimport { useEffect, useRef, useState, useCallback, useMemo } from 'react';\nimport { useRouter } from 'next/navigation';\nimport { useChat, type UseChatHelpers } from '@ai-sdk/react';\nimport { TextStreamChatTransport, type UIMessage } from 'ai';\nimport { motion, AnimatePresence } from 'framer-motion';\nimport ReactMarkdown from 'react-markdown';\nimport remarkGfm from 'remark-gfm';\nimport {\n  MessageSquare,\n  X,\n  Maximize2,\n  Minimize2,\n  Send,\n  Loader2,\n  Plus,\n  Bot,\n  User,\n  Sparkles,\n  CheckCircle2,\n  AlertCircle,\n  Square,\n  Settings,\n  History,\n  Trash2,\n  Clock,\n  ChevronLeft,\n  Package,\n  ShoppingCart,\n  FileText,\n  Users,\n  PenLine,\n} from 'lucide-react';\nimport { Button } from '../ui/button';\nimport { Textarea } from '../ui/textarea';\nimport { ScrollArea } from '../ui/scroll-area';\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from '../ui/tooltip';\nimport { cn } from '../../lib/utils';\nimport { useChatStore, useChatPanel, useChatContext } from '../../lib/ai/chat-store';\nimport { useAutoChatContext } from '../../hooks/use-chat-context';\n\n// Animated typing dots component\nconst TypingDots = () => (\n  <div className=\"flex items-center gap-1\">\n    {[0, 1, 2].map((i) => (\n      <motion.span\n        key={i}\n        className=\"size-1.5 rounded-full bg-primary\"\n        animate={{ scale: [1, 1.3, 1], opacity: [0.4, 1, 0.4] }}\n        transition={{ duration: 1, repeat: Infinity, delay: i * 0.2 }}\n      />\n    ))}\n  </div>\n);\n\n// Types for message parts\ninterface TextPart {\n  type: 'text';\n  text: string;\n}\n\ninterface ToolInvocationPart {\n  type: string;\n  toolCallId: string;\n  toolName?: string;\n  state: 'call' | 'partial-call' | 'result';\n  args?: Record<string, unknown>;\n  result?: unknown;\n}\n\ninterface ReasoningPart {\n  type: 'reasoning';\n  text: string;\n}\n\ntype MessagePart = TextPart | ToolInvocationPart | ReasoningPart | { type: string; [key: string]: unknown };\n\n// Helper to check if part is a text part\nfunction isTextPart(part: MessagePart): part is TextPart {\n  return part.type === 'text' && 'text' in part;\n}\n\n// Helper to check if part is a tool invocation\nfunction isToolPart(part: MessagePart): part is ToolInvocationPart {\n  return (\n    (part.type.startsWith('tool-') || part.type === 'tool-invocation') &&\n    'toolCallId' in part &&\n    'state' in part\n  );\n}\n\n// Helper to check if part is reasoning\nfunction isReasoningPart(part: MessagePart): part is ReasoningPart {\n  return part.type === 'reasoning' && 'text' in part;\n}\n\n// Get tool name from part\nfunction getToolName(part: ToolInvocationPart): string {\n  if (part.toolName) return part.toolName;\n  if (part.type.startsWith('tool-')) return part.type.slice(5);\n  return 'unknown';\n}\n\n// Process message parts for rendering\nfunction processMessageParts(message: UIMessage): {\n  textParts: TextPart[];\n  toolParts: ToolInvocationPart[];\n  reasoningParts: ReasoningPart[];\n} {\n  const parts = (message.parts || []) as MessagePart[];\n\n  return {\n    textParts: parts.filter(isTextPart),\n    toolParts: parts.filter(isToolPart),\n    reasoningParts: parts.filter(isReasoningPart),\n  };\n}\n\n// Get combined text from message\nfunction getMessageText(message: UIMessage): string {\n  const { textParts } = processMessageParts(message);\n  return textParts.map((part) => part.text).join('');\n}\n\n// Suggested actions for empty state\nconst SUGGESTED_ACTIONS = [\n  { label: 'Show dashboard stats', icon: 'üìä' },\n  { label: 'Search products', icon: 'üîç' },\n  { label: 'Recent orders', icon: 'üì¶' },\n  { label: 'Help me navigate', icon: 'üß≠' },\n];\n\n// Get icon for context type\nfunction getContextIcon(type: string) {\n  switch (type) {\n    case 'product':\n      return Package;\n    case 'order':\n      return ShoppingCart;\n    case 'page':\n      return FileText;\n    case 'blog':\n      return PenLine;\n    case 'user':\n      return Users;\n    default:\n      return MessageSquare;\n  }\n}\n\n// Format relative time\nfunction formatRelativeTime(date: Date): string {\n  const now = new Date();\n  const diffMs = now.getTime() - new Date(date).getTime();\n  const diffMins = Math.floor(diffMs / 60000);\n  const diffHours = Math.floor(diffMins / 60);\n  const diffDays = Math.floor(diffHours / 24);\n\n  if (diffMins < 1) return 'Just now';\n  if (diffMins < 60) return `${diffMins}m ago`;\n  if (diffHours < 24) return `${diffHours}h ago`;\n  if (diffDays < 7) return `${diffDays}d ago`;\n  return new Date(date).toLocaleDateString();\n}\n\nexport function ChatPanel() {\n  useAutoChatContext();\n  const router = useRouter();\n  const { mode, setMode, togglePanel } = useChatPanel();\n  const { context } = useChatContext();\n  const conversationId = useChatStore((s) => s.conversationId);\n  const startNewConversation = useChatStore((s) => s.startNewConversation);\n  const addToHistory = useChatStore((s) => s.addToHistory);\n  const conversationHistory = useChatStore((s) => s.conversationHistory);\n  const loadConversation = useChatStore((s) => s.loadConversation);\n  const removeFromHistory = useChatStore((s) => s.removeFromHistory);\n  const clearHistory = useChatStore((s) => s.clearHistory);\n\n  const scrollRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLTextAreaElement>(null);\n  const [inputValue, setInputValue] = useState('');\n  const [aiError, setAiError] = useState<string | null>(null);\n  const [showHistory, setShowHistory] = useState(false);\n\n  // Initialize conversation ID if not set\n  useEffect(() => {\n    if (!conversationId) {\n      startNewConversation();\n    }\n  }, [conversationId, startNewConversation]);\n\n  // Create transport with body that includes context\n  const transport = useMemo(() => {\n    return new TextStreamChatTransport({\n      api: '/api/chat',\n      body: {\n        id: conversationId,\n        context,\n      },\n    });\n  }, [conversationId, context]);\n\n  // Use the AI SDK v6 useChat hook\n  const {\n    messages,\n    status,\n    sendMessage,\n    setMessages,\n    stop,\n    error,\n  } = useChat({\n    id: conversationId || undefined,\n    transport,\n    onError: (err) => {\n      // Parse error for better display\n      const errorMessage = err.message || 'An error occurred';\n      if (errorMessage.includes('AI is not enabled') || errorMessage.includes('No API key')) {\n        setAiError('AI is not configured. Please add your API key in Settings > AI.');\n      } else if (errorMessage.includes('rate limit')) {\n        setAiError('Rate limit reached. Please try again later.');\n      } else {\n        setAiError(errorMessage);\n      }\n    },\n    onFinish: ({ message }) => {\n      setAiError(null);\n      // Update history\n      if (conversationId && messages.length > 0) {\n        const firstUserMessage = messages.find((m) => m.role === 'user');\n        const firstUserText = firstUserMessage ? getMessageText(firstUserMessage) : '';\n        const messageText = getMessageText(message);\n\n        addToHistory({\n          id: conversationId,\n          title: firstUserText?.slice(0, 50) || 'New Chat',\n          lastMessage: messageText?.slice(0, 100) || '',\n          context: context,\n        });\n      }\n    },\n  });\n\n  // Handle loading a conversation from history\n  const handleLoadConversation = useCallback((id: string) => {\n    loadConversation(id);\n    setMessages([]);\n    setShowHistory(false);\n    setAiError(null);\n  }, [loadConversation, setMessages]);\n\n  const isLoading = status === 'submitted' || status === 'streaming';\n  const isStreaming = status === 'streaming';\n\n  // Auto-scroll to bottom on new messages\n  useEffect(() => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }\n  }, [messages]);\n\n  // Handle send message\n  const handleSend = useCallback(async () => {\n    if (!inputValue.trim() || isLoading) return;\n\n    const messageContent = inputValue.trim();\n    setInputValue('');\n    setAiError(null);\n\n    await sendMessage({ text: messageContent });\n\n    inputRef.current?.focus();\n  }, [inputValue, isLoading, sendMessage]);\n\n  // Handle key press\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === 'Enter' && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  };\n\n  // Handle new conversation\n  const handleNewConversation = () => {\n    startNewConversation();\n    setMessages([]);\n    setAiError(null);\n  };\n\n  // Handle stop\n  const handleStop = useCallback(() => {\n    stop();\n  }, [stop]);\n\n  // If collapsed, show only the floating button\n  if (mode === 'collapsed') {\n    return (\n      <motion.div\n        initial={{ scale: 0, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        exit={{ scale: 0, opacity: 0 }}\n        transition={{ type: 'spring', stiffness: 400, damping: 25 }}\n        className=\"fixed bottom-6 right-6 z-50\"\n      >\n        <TooltipProvider>\n          <Tooltip>\n            <TooltipTrigger asChild>\n              <Button\n                onClick={togglePanel}\n                size=\"icon\"\n                className={cn(\n                  'h-14 w-14 rounded-full shadow-lg',\n                  'bg-gradient-to-br from-primary to-primary/80',\n                  'hover:scale-110 hover:shadow-xl hover:shadow-primary/20',\n                  'active:scale-95',\n                  'transition-all duration-200'\n                )}\n              >\n                <Sparkles className=\"h-6 w-6\" />\n              </Button>\n            </TooltipTrigger>\n            <TooltipContent side=\"left\">\n              <p>Open AI Assistant</p>\n            </TooltipContent>\n          </Tooltip>\n        </TooltipProvider>\n        <span className=\"absolute inset-0 -z-10 rounded-full bg-primary/20 animate-ping\" />\n      </motion.div>\n    );\n  }\n\n  const isFullScreen = mode === 'full';\n\n  return (\n    <motion.div\n      initial={{ x: 400, opacity: 0 }}\n      animate={{ x: 0, opacity: 1 }}\n      exit={{ x: 400, opacity: 0 }}\n      transition={{ type: 'spring', stiffness: 300, damping: 30 }}\n      className={cn(\n        'fixed z-50 flex flex-col bg-background/95 backdrop-blur-xl border-l shadow-2xl',\n        isFullScreen\n          ? 'inset-0'\n          : 'top-0 right-0 bottom-0 w-[420px] max-w-full'\n      )}\n    >\n      {/* Header */}\n      <div className=\"flex items-center justify-between px-4 py-3 border-b bg-gradient-to-r from-muted/50 to-transparent\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"flex size-9 items-center justify-center rounded-xl bg-gradient-to-br from-primary/20 to-primary/5 ring-1 ring-primary/20\">\n            <Sparkles className=\"h-4 w-4 text-primary\" />\n          </div>\n          <div className=\"flex flex-col\">\n            <span className=\"font-semibold text-sm\">AI Assistant</span>\n            {context.type !== 'general' && (\n              <span className=\"text-xs text-muted-foreground capitalize\">\n                {context.type}: {context.title || context.id}\n              </span>\n            )}\n          </div>\n        </div>\n        <div className=\"flex items-center gap-0.5\">\n          <TooltipProvider>\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={() => setShowHistory(!showHistory)}\n                  className={cn(\n                    'rounded-lg transition-colors h-8 w-8',\n                    showHistory ? 'bg-primary/10 text-primary' : 'hover:bg-muted'\n                  )}\n                >\n                  <History className=\"h-4 w-4\" />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>Conversation history</TooltipContent>\n            </Tooltip>\n\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={handleNewConversation}\n                  className=\"rounded-lg hover:bg-muted transition-colors h-8 w-8\"\n                >\n                  <Plus className=\"h-4 w-4\" />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>New conversation</TooltipContent>\n            </Tooltip>\n\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={() => setMode(isFullScreen ? 'side' : 'full')}\n                  className=\"rounded-lg hover:bg-muted transition-colors h-8 w-8\"\n                >\n                  {isFullScreen ? (\n                    <Minimize2 className=\"h-4 w-4\" />\n                  ) : (\n                    <Maximize2 className=\"h-4 w-4\" />\n                  )}\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>{isFullScreen ? 'Minimize' : 'Maximize'}</TooltipContent>\n            </Tooltip>\n\n            <Tooltip>\n              <TooltipTrigger asChild>\n                <Button\n                  variant=\"ghost\"\n                  size=\"icon\"\n                  onClick={() => setMode('collapsed')}\n                  className=\"rounded-lg hover:bg-destructive/10 hover:text-destructive transition-colors h-8 w-8\"\n                >\n                  <X className=\"h-4 w-4\" />\n                </Button>\n              </TooltipTrigger>\n              <TooltipContent>Close</TooltipContent>\n            </Tooltip>\n          </TooltipProvider>\n        </div>\n      </div>\n\n      {/* Error Banner */}\n      <AnimatePresence>\n        {aiError && (\n          <motion.div\n            initial={{ height: 0, opacity: 0 }}\n            animate={{ height: 'auto', opacity: 1 }}\n            exit={{ height: 0, opacity: 0 }}\n            className=\"border-b border-destructive/20 bg-destructive/5 overflow-hidden\"\n          >\n            <div className=\"flex items-center gap-3 px-4 py-3\">\n              <AlertCircle className=\"h-4 w-4 text-destructive shrink-0\" />\n              <p className=\"text-sm text-destructive flex-1\">{aiError}</p>\n              {aiError.includes('Settings') && (\n                <Button\n                  variant=\"outline\"\n                  size=\"sm\"\n                  onClick={() => router.push('/admin/settings')}\n                  className=\"shrink-0\"\n                >\n                  <Settings className=\"h-3 w-3 mr-1\" />\n                  Settings\n                </Button>\n              )}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* History Panel */}\n      <AnimatePresence>\n        {showHistory && (\n          <motion.div\n            initial={{ opacity: 0, height: 0 }}\n            animate={{ opacity: 1, height: 'auto' }}\n            exit={{ opacity: 0, height: 0 }}\n            className=\"border-b bg-muted/30 overflow-hidden\"\n          >\n            <div className=\"p-3\">\n              <div className=\"flex items-center justify-between mb-3\">\n                <div className=\"flex items-center gap-2\">\n                  <History className=\"h-4 w-4 text-muted-foreground\" />\n                  <span className=\"text-sm font-medium\">Recent Conversations</span>\n                  <span className=\"text-xs text-muted-foreground\">\n                    ({conversationHistory.length})\n                  </span>\n                </div>\n                {conversationHistory.length > 0 && (\n                  <TooltipProvider>\n                    <Tooltip>\n                      <TooltipTrigger asChild>\n                        <Button\n                          variant=\"ghost\"\n                          size=\"sm\"\n                          onClick={() => {\n                            if (confirm('Clear all conversation history?')) {\n                              clearHistory();\n                            }\n                          }}\n                          className=\"h-7 text-xs text-muted-foreground hover:text-destructive\"\n                        >\n                          <Trash2 className=\"h-3 w-3\" />\n                        </Button>\n                      </TooltipTrigger>\n                      <TooltipContent>Clear history</TooltipContent>\n                    </Tooltip>\n                  </TooltipProvider>\n                )}\n              </div>\n\n              {conversationHistory.length === 0 ? (\n                <div className=\"text-center py-6 text-muted-foreground\">\n                  <Clock className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n                  <p className=\"text-sm\">No conversation history yet</p>\n                  <p className=\"text-xs mt-1\">Start a conversation to see it here</p>\n                </div>\n              ) : (\n                <ScrollArea className=\"max-h-[200px]\">\n                  <div className=\"space-y-1\">\n                    {conversationHistory.map((conv) => {\n                      const ContextIcon = conv.context\n                        ? getContextIcon(conv.context.type)\n                        : MessageSquare;\n                      const isActive = conv.id === conversationId;\n\n                      return (\n                        <motion.div\n                          key={conv.id}\n                          initial={{ opacity: 0, x: -10 }}\n                          animate={{ opacity: 1, x: 0 }}\n                          className=\"group relative\"\n                        >\n                          <button\n                            onClick={() => handleLoadConversation(conv.id)}\n                            className={cn(\n                              'w-full text-left p-2.5 rounded-lg transition-all duration-200',\n                              'hover:bg-background/80 hover:shadow-sm',\n                              isActive && 'bg-primary/5 ring-1 ring-primary/20'\n                            )}\n                          >\n                            <div className=\"flex items-start gap-2.5\">\n                              <div\n                                className={cn(\n                                  'flex size-7 shrink-0 items-center justify-center rounded-md',\n                                  'bg-muted/80',\n                                  isActive && 'bg-primary/10'\n                                )}\n                              >\n                                <ContextIcon\n                                  className={cn(\n                                    'h-3.5 w-3.5',\n                                    isActive ? 'text-primary' : 'text-muted-foreground'\n                                  )}\n                                />\n                              </div>\n                              <div className=\"flex-1 min-w-0\">\n                                <div className=\"flex items-center gap-2\">\n                                  <span\n                                    className={cn(\n                                      'text-sm font-medium truncate',\n                                      isActive && 'text-primary'\n                                    )}\n                                  >\n                                    {conv.title || 'Untitled Chat'}\n                                  </span>\n                                  {isActive && (\n                                    <span className=\"text-[10px] bg-primary/10 text-primary px-1.5 py-0.5 rounded-full\">\n                                      Active\n                                    </span>\n                                  )}\n                                </div>\n                                <p className=\"text-xs text-muted-foreground truncate mt-0.5\">\n                                  {conv.lastMessage || 'No messages'}\n                                </p>\n                                <div className=\"flex items-center gap-2 mt-1\">\n                                  {conv.context && conv.context.type !== 'general' && (\n                                    <span className=\"text-[10px] bg-muted px-1.5 py-0.5 rounded capitalize\">\n                                      {conv.context.type}\n                                      {conv.context.id && `: ${conv.context.id.slice(0, 8)}...`}\n                                    </span>\n                                  )}\n                                  <span className=\"text-[10px] text-muted-foreground/70\">\n                                    {formatRelativeTime(conv.updatedAt)}\n                                  </span>\n                                </div>\n                              </div>\n                            </div>\n                          </button>\n                          <TooltipProvider>\n                            <Tooltip>\n                              <TooltipTrigger asChild>\n                                <Button\n                                  variant=\"ghost\"\n                                  size=\"icon\"\n                                  onClick={(e) => {\n                                    e.stopPropagation();\n                                    removeFromHistory(conv.id);\n                                  }}\n                                  className={cn(\n                                    'absolute right-2 top-2 h-6 w-6 opacity-0 group-hover:opacity-100',\n                                    'hover:bg-destructive/10 hover:text-destructive transition-all'\n                                  )}\n                                >\n                                  <Trash2 className=\"h-3 w-3\" />\n                                </Button>\n                              </TooltipTrigger>\n                              <TooltipContent>Remove from history</TooltipContent>\n                            </Tooltip>\n                          </TooltipProvider>\n                        </motion.div>\n                      );\n                    })}\n                  </div>\n                </ScrollArea>\n              )}\n            </div>\n          </motion.div>\n        )}\n      </AnimatePresence>\n\n      {/* Messages */}\n      <ScrollArea className=\"flex-1 p-4\" ref={scrollRef}>\n        {messages.length === 0 ? (\n          <motion.div\n            initial={{ opacity: 0, y: 20 }}\n            animate={{ opacity: 1, y: 0 }}\n            transition={{ duration: 0.5, delay: 0.2 }}\n            className=\"flex flex-col items-center justify-center h-full text-center py-12\"\n          >\n            <motion.div\n              animate={{\n                boxShadow: [\n                  '0 0 0 0 rgba(var(--primary), 0)',\n                  '0 0 40px 10px rgba(var(--primary), 0.1)',\n                  '0 0 0 0 rgba(var(--primary), 0)',\n                ],\n              }}\n              transition={{ duration: 3, repeat: Infinity }}\n              className=\"flex size-16 items-center justify-center rounded-2xl bg-gradient-to-br from-primary/20 to-primary/5 ring-1 ring-primary/20 mb-6\"\n            >\n              <Sparkles className=\"h-8 w-8 text-primary\" />\n            </motion.div>\n            <motion.p\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ delay: 0.4 }}\n              className=\"text-xl font-semibold\"\n            >\n              How can I help you?\n            </motion.p>\n            <motion.p\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ delay: 0.5 }}\n              className=\"text-sm mt-2 max-w-[280px] text-muted-foreground\"\n            >\n              I can help you manage products, orders, content, navigate the admin panel, and more.\n            </motion.p>\n            <motion.div\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              transition={{ delay: 0.6 }}\n              className=\"mt-6 grid grid-cols-2 gap-2 w-full max-w-[320px]\"\n            >\n              {SUGGESTED_ACTIONS.map((action, i) => (\n                <motion.div\n                  key={action.label}\n                  initial={{ opacity: 0, scale: 0.9 }}\n                  animate={{ opacity: 1, scale: 1 }}\n                  transition={{ delay: 0.7 + i * 0.1 }}\n                >\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    className=\"w-full justify-start text-left h-auto py-2.5 px-3 hover:bg-primary/5 hover:border-primary/30 transition-all duration-200\"\n                    onClick={() => {\n                      setInputValue(action.label);\n                      inputRef.current?.focus();\n                    }}\n                  >\n                    <span className=\"mr-2\">{action.icon}</span>\n                    <span className=\"truncate text-xs\">{action.label}</span>\n                  </Button>\n                </motion.div>\n              ))}\n            </motion.div>\n          </motion.div>\n        ) : (\n          <div className=\"space-y-4\">\n            <AnimatePresence mode=\"popLayout\">\n              {messages.map((message, index) => {\n                const { textParts, toolParts, reasoningParts } = processMessageParts(message);\n                const isLastMessage = index === messages.length - 1;\n\n                return (\n                  <motion.div\n                    key={message.id}\n                    initial={{ opacity: 0, y: 10, scale: 0.98 }}\n                    animate={{ opacity: 1, y: 0, scale: 1 }}\n                    transition={{\n                      duration: 0.3,\n                      ease: [0.25, 0.46, 0.45, 0.94],\n                    }}\n                    className={cn(\n                      'flex gap-3',\n                      message.role === 'user' ? 'flex-row-reverse' : ''\n                    )}\n                  >\n                    <div\n                      className={cn(\n                        'flex-shrink-0 w-8 h-8 rounded-xl flex items-center justify-center',\n                        message.role === 'user'\n                          ? 'bg-primary text-primary-foreground'\n                          : 'bg-gradient-to-br from-primary/15 to-primary/5 ring-1 ring-primary/20'\n                      )}\n                    >\n                      {message.role === 'user' ? (\n                        <User className=\"h-4 w-4\" />\n                      ) : (\n                        <Sparkles className=\"h-4 w-4 text-primary\" />\n                      )}\n                    </div>\n                    <div\n                      className={cn(\n                        'flex-1 max-w-[85%] space-y-2',\n                        message.role === 'user' ? 'flex flex-col items-end' : ''\n                      )}\n                    >\n                      {/* Reasoning parts (for reasoning models) */}\n                      {reasoningParts.length > 0 && (\n                        <div className=\"text-xs text-muted-foreground bg-muted/30 rounded-lg px-3 py-2 border-l-2 border-primary/30\">\n                          <div className=\"flex items-center gap-1 mb-1 font-medium\">\n                            <Loader2 className=\"h-3 w-3 animate-spin\" />\n                            Thinking...\n                          </div>\n                          <p className=\"italic opacity-70\">\n                            {reasoningParts.map((p) => p.text).join('')}\n                          </p>\n                        </div>\n                      )}\n\n                      {/* Tool invocations - rendered inline as they stream */}\n                      {toolParts.map((tool, i) => (\n                        <motion.div\n                          key={tool.toolCallId}\n                          initial={{ opacity: 0, x: -10 }}\n                          animate={{ opacity: 1, x: 0 }}\n                          transition={{ delay: i * 0.05 }}\n                          className={cn(\n                            'text-xs rounded-lg px-3 py-2 flex items-center gap-2',\n                            'bg-muted/50 border border-border/50'\n                          )}\n                        >\n                          <div\n                            className={cn(\n                              'flex size-5 items-center justify-center rounded-md',\n                              tool.state === 'result'\n                                ? 'bg-green-500/10'\n                                : 'bg-primary/10'\n                            )}\n                          >\n                            {tool.state === 'result' ? (\n                              <CheckCircle2 className=\"h-3 w-3 text-green-600\" />\n                            ) : (\n                              <Loader2 className=\"h-3 w-3 animate-spin text-primary\" />\n                            )}\n                          </div>\n                          <span className=\"font-medium\">{getToolName(tool)}</span>\n                          {tool.state === 'result' && (\n                            <span className=\"text-green-600 ml-auto\">Done</span>\n                          )}\n                          {(tool.state === 'call' || tool.state === 'partial-call') && (\n                            <span className=\"text-muted-foreground ml-auto\">\n                              {tool.state === 'partial-call' ? 'Preparing...' : 'Running...'}\n                            </span>\n                          )}\n                        </motion.div>\n                      ))}\n\n                      {/* Text content */}\n                      {textParts.length > 0 && (\n                        <div\n                          className={cn(\n                            'rounded-2xl px-4 py-3',\n                            message.role === 'user'\n                              ? 'bg-primary text-primary-foreground rounded-tr-sm'\n                              : 'bg-muted/50 rounded-tl-sm'\n                          )}\n                        >\n                          {message.role === 'assistant' ? (\n                            <div className=\"prose prose-sm dark:prose-invert max-w-none prose-p:my-1 prose-ul:my-1 prose-ol:my-1 prose-li:my-0.5 prose-headings:my-2 prose-pre:my-2 prose-code:bg-muted prose-code:px-1 prose-code:rounded\">\n                              <ReactMarkdown remarkPlugins={[remarkGfm]}>\n                                {textParts.map((p) => p.text).join('')}\n                              </ReactMarkdown>\n                            </div>\n                          ) : (\n                            <p className=\"text-sm whitespace-pre-wrap\">\n                              {textParts.map((p) => p.text).join('')}\n                            </p>\n                          )}\n                        </div>\n                      )}\n                    </div>\n                  </motion.div>\n                );\n              })}\n            </AnimatePresence>\n\n            {/* Thinking indicator */}\n            <AnimatePresence>\n              {isLoading && (\n                <motion.div\n                  initial={{ opacity: 0, y: 10 }}\n                  animate={{ opacity: 1, y: 0 }}\n                  exit={{ opacity: 0, y: -10 }}\n                  className=\"flex gap-3\"\n                >\n                  <motion.div\n                    animate={{ scale: [1, 1.05, 1] }}\n                    transition={{ duration: 2, repeat: Infinity }}\n                    className=\"flex-shrink-0 w-8 h-8 rounded-xl bg-gradient-to-br from-primary/15 to-primary/5 ring-1 ring-primary/20 flex items-center justify-center\"\n                  >\n                    <Sparkles className=\"h-4 w-4 text-primary\" />\n                  </motion.div>\n                  <div className=\"bg-muted/50 rounded-2xl rounded-tl-sm px-4 py-3 flex items-center gap-2\">\n                    <TypingDots />\n                    <span className=\"text-xs text-muted-foreground\">Thinking...</span>\n                  </div>\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </div>\n        )}\n      </ScrollArea>\n\n      {/* Input */}\n      <div className=\"p-4 border-t bg-gradient-to-t from-muted/30 to-transparent\">\n        <motion.div\n          initial={{ opacity: 0, y: 10 }}\n          animate={{ opacity: 1, y: 0 }}\n          transition={{ duration: 0.3, delay: 0.1 }}\n          className={cn(\n            'flex items-end gap-2 rounded-xl border p-2',\n            'bg-background/80 backdrop-blur-sm shadow-lg',\n            'transition-all duration-300 ease-out',\n            'border-border/50 hover:border-border',\n            'focus-within:border-primary/50 focus-within:shadow-xl focus-within:shadow-primary/5',\n            'focus-within:ring-2 focus-within:ring-primary/10'\n          )}\n        >\n          <Textarea\n            ref={inputRef}\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Ask me anything...\"\n            className={cn(\n              'min-h-[44px] max-h-[120px] resize-none flex-1',\n              'border-none bg-transparent shadow-none',\n              'focus-visible:ring-0 focus-visible:outline-none',\n              'placeholder:text-muted-foreground/60'\n            )}\n            rows={1}\n            disabled={isLoading}\n          />\n          <motion.div whileHover={{ scale: 1.05 }} whileTap={{ scale: 0.95 }}>\n            {isStreaming ? (\n              <Button\n                onClick={handleStop}\n                size=\"icon\"\n                variant=\"outline\"\n                className=\"h-10 w-10 rounded-full shrink-0 border-destructive/50 hover:bg-destructive/10 hover:border-destructive\"\n              >\n                <Square className=\"h-4 w-4 text-destructive\" />\n              </Button>\n            ) : (\n              <Button\n                onClick={handleSend}\n                disabled={!inputValue.trim() || isLoading}\n                size=\"icon\"\n                className={cn(\n                  'h-10 w-10 rounded-full shrink-0',\n                  'bg-gradient-to-br from-primary to-primary/80',\n                  'shadow-md hover:shadow-lg hover:shadow-primary/20',\n                  'transition-all duration-200',\n                  'disabled:opacity-50 disabled:shadow-none'\n                )}\n              >\n                {status === 'submitted' ? (\n                  <Loader2 className=\"h-4 w-4 animate-spin\" />\n                ) : (\n                  <Send className=\"h-4 w-4\" />\n                )}\n              </Button>\n            )}\n          </motion.div>\n        </motion.div>\n        <p className=\"text-[10px] text-muted-foreground/50 text-center mt-2\">\n          Press Enter to send, Shift+Enter for new line\n        </p>\n      </div>\n    </motion.div>\n  );\n}\n","import * as React from \"react\"\n\nimport { cn } from '../../lib/utils'\n\nfunction Textarea({ className, ...props }: React.ComponentProps<\"textarea\">) {\n  return (\n    <textarea\n      data-slot=\"textarea\"\n      className={cn(\n        \"border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport { Textarea }\n","\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from '../../lib/utils'\n\nfunction TooltipProvider({\n  delayDuration = 0,\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Provider>) {\n  return (\n    <TooltipPrimitive.Provider\n      data-slot=\"tooltip-provider\"\n      delayDuration={delayDuration}\n      {...props}\n    />\n  )\n}\n\nfunction Tooltip({\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Root>) {\n  return (\n    <TooltipProvider>\n      <TooltipPrimitive.Root data-slot=\"tooltip\" {...props} />\n    </TooltipProvider>\n  )\n}\n\nfunction TooltipTrigger({\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Trigger>) {\n  return <TooltipPrimitive.Trigger data-slot=\"tooltip-trigger\" {...props} />\n}\n\nfunction TooltipContent({\n  className,\n  sideOffset = 0,\n  children,\n  ...props\n}: React.ComponentProps<typeof TooltipPrimitive.Content>) {\n  return (\n    <TooltipPrimitive.Portal>\n      <TooltipPrimitive.Content\n        data-slot=\"tooltip-content\"\n        sideOffset={sideOffset}\n        className={cn(\n          \"bg-foreground text-background animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n        <TooltipPrimitive.Arrow className=\"bg-foreground fill-foreground z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]\" />\n      </TooltipPrimitive.Content>\n    </TooltipPrimitive.Portal>\n  )\n}\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","/**\n * Chat State Store (Zustand)\n *\n * Global state management for the admin chat panel.\n * Persists across route changes within the admin panel.\n */\n\nimport { create } from 'zustand';\nimport { persist } from 'zustand/middleware';\nimport type { ChatMessage } from './types';\n\nexport type ChatPanelMode = 'collapsed' | 'side' | 'full';\n\nexport interface ChatContext {\n  type: 'general' | 'product' | 'order' | 'page' | 'user' | 'blog';\n  id?: string;\n  title?: string;\n  data?: Record<string, unknown>;\n}\n\ninterface ChatState {\n  // Panel state\n  mode: ChatPanelMode;\n  setMode: (mode: ChatPanelMode) => void;\n  togglePanel: () => void;\n\n  // Current conversation\n  conversationId: string | null;\n  messages: ChatMessage[];\n  isLoading: boolean;\n  error: string | null;\n\n  // Context awareness\n  context: ChatContext;\n  setContext: (context: ChatContext) => void;\n\n  // Message actions\n  addMessage: (message: ChatMessage) => void;\n  updateMessage: (id: string, updates: Partial<ChatMessage>) => void;\n  setMessages: (messages: ChatMessage[]) => void;\n  clearMessages: () => void;\n\n  // Conversation actions\n  setConversationId: (id: string | null) => void;\n  startNewConversation: () => void;\n  setLoading: (loading: boolean) => void;\n  setError: (error: string | null) => void;\n\n  // History\n  conversationHistory: Array<{\n    id: string;\n    title: string;\n    lastMessage: string;\n    updatedAt: Date;\n    context?: ChatContext;\n  }>;\n  addToHistory: (conversation: { id: string; title: string; lastMessage: string; context?: ChatContext }) => void;\n  removeFromHistory: (id: string) => void;\n  loadConversation: (id: string) => void;\n  clearHistory: () => void;\n}\n\nexport const useChatStore = create<ChatState>()(\n  persist(\n    (set, get) => ({\n      // Panel state\n      mode: 'collapsed',\n      setMode: (mode) => set({ mode }),\n      togglePanel: () => {\n        const current = get().mode;\n        if (current === 'collapsed') {\n          set({ mode: 'side' });\n        } else {\n          set({ mode: 'collapsed' });\n        }\n      },\n\n      // Current conversation\n      conversationId: null,\n      messages: [],\n      isLoading: false,\n      error: null,\n\n      // Context\n      context: { type: 'general' },\n      setContext: (context) => set({ context }),\n\n      // Message actions\n      addMessage: (message) =>\n        set((state) => ({\n          messages: [...state.messages, message],\n        })),\n      updateMessage: (id, updates) =>\n        set((state) => ({\n          messages: state.messages.map((msg) =>\n            msg.id === id ? { ...msg, ...updates } : msg\n          ),\n        })),\n      setMessages: (messages) => set({ messages }),\n      clearMessages: () => set({ messages: [] }),\n\n      // Conversation actions\n      setConversationId: (id) => set({ conversationId: id }),\n      startNewConversation: () => {\n        const newId = crypto.randomUUID();\n        set({\n          conversationId: newId,\n          messages: [],\n          error: null,\n        });\n      },\n      setLoading: (isLoading) => set({ isLoading }),\n      setError: (error) => set({ error }),\n\n      // History\n      conversationHistory: [],\n      addToHistory: (conversation) =>\n        set((state) => {\n          // Remove existing entry if present, add to top\n          const filtered = state.conversationHistory.filter(\n            (c) => c.id !== conversation.id\n          );\n          return {\n            conversationHistory: [\n              { ...conversation, updatedAt: new Date() },\n              ...filtered,\n            ].slice(0, 50), // Keep last 50 conversations\n          };\n        }),\n      removeFromHistory: (id) =>\n        set((state) => ({\n          conversationHistory: state.conversationHistory.filter(\n            (c) => c.id !== id\n          ),\n        })),\n      loadConversation: (id) => {\n        const history = get().conversationHistory.find((c) => c.id === id);\n        if (history) {\n          set({\n            conversationId: id,\n            messages: [], // Messages will be loaded from the useChat hook via transport\n            error: null,\n            context: history.context || { type: 'general' },\n          });\n        }\n      },\n      clearHistory: () => set({ conversationHistory: [] }),\n    }),\n    {\n      name: 'admin-chat-storage',\n      partialize: (state) => ({\n        // Only persist these fields\n        mode: state.mode,\n        conversationId: state.conversationId,\n        messages: state.messages,\n        conversationHistory: state.conversationHistory,\n      }),\n    }\n  )\n);\n\n// Selector hooks for common patterns\nexport const useChatPanel = () => {\n  const mode = useChatStore((s) => s.mode);\n  const setMode = useChatStore((s) => s.setMode);\n  const togglePanel = useChatStore((s) => s.togglePanel);\n  return { mode, setMode, togglePanel };\n};\n\nexport const useChatMessages = () => {\n  const messages = useChatStore((s) => s.messages);\n  const addMessage = useChatStore((s) => s.addMessage);\n  const updateMessage = useChatStore((s) => s.updateMessage);\n  const setMessages = useChatStore((s) => s.setMessages);\n  const clearMessages = useChatStore((s) => s.clearMessages);\n  return { messages, addMessage, updateMessage, setMessages, clearMessages };\n};\n\nexport const useChatContext = () => {\n  const context = useChatStore((s) => s.context);\n  const setContext = useChatStore((s) => s.setContext);\n  return { context, setContext };\n};\n","'use client';\n\n/**\n * Hook to manage chat context based on current route and entity\n *\n * Automatically detects the current page type and entity from the URL\n * and updates the chat store context with entity titles when available.\n */\n\nimport { useEffect, useRef } from 'react';\nimport { usePathname, useParams } from 'next/navigation';\nimport { useChatContext } from '../lib/ai/chat-store';\nimport type { ChatContext } from '../lib/ai/chat-store';\n\ninterface ContextData {\n  title?: string;\n  data?: Record<string, unknown>;\n}\n\n/**\n * Fetch entity title based on context type and ID\n */\nasync function fetchEntityTitle(\n  type: ChatContext['type'],\n  id: string\n): Promise<string | null> {\n  try {\n    let endpoint = '';\n    switch (type) {\n      case 'product':\n        endpoint = `/api/admin/products/${id}`;\n        break;\n      case 'order':\n        endpoint = `/api/admin/orders/${id}`;\n        break;\n      case 'page':\n        endpoint = `/api/admin/pages/${id}`;\n        break;\n      case 'blog':\n        endpoint = `/api/admin/blog/${id}`;\n        break;\n      case 'user':\n        endpoint = `/api/admin/customers/${id}`;\n        break;\n      default:\n        return null;\n    }\n\n    const response = await fetch(endpoint);\n    if (!response.ok) return null;\n\n    const data = await response.json();\n\n    // Extract title based on entity type\n    switch (type) {\n      case 'product':\n        return data.name || data.title || null;\n      case 'order':\n        return `Order #${data.orderNumber || id.slice(0, 8)}`;\n      case 'page':\n        return data.title || data.name || null;\n      case 'blog':\n        return data.title || null;\n      case 'user':\n        return data.name || data.email || null;\n      default:\n        return null;\n    }\n  } catch (error) {\n    console.error('Failed to fetch entity title:', error);\n    return null;\n  }\n}\n\n/**\n * Hook that automatically sets chat context based on current route\n * and fetches entity titles when possible\n */\nexport function useAutoChatContext() {\n  const pathname = usePathname();\n  const params = useParams();\n  const { context, setContext } = useChatContext();\n  const lastFetchedRef = useRef<string | null>(null);\n\n  // Update context when path changes\n  useEffect(() => {\n    if (!pathname) return;\n\n    const newContext = detectContextFromPath(pathname, params);\n\n    // Only update if context changed\n    if (\n      newContext.type !== context.type ||\n      newContext.id !== context.id\n    ) {\n      setContext(newContext);\n\n      // Reset the last fetched ref when context changes\n      lastFetchedRef.current = null;\n    }\n  }, [pathname, params, setContext, context.type, context.id]);\n\n  // Fetch entity title when we have an ID\n  useEffect(() => {\n    const fetchTitle = async () => {\n      // Skip if already fetched, no ID, or already has title\n      if (!context.id || context.title || context.type === 'general') return;\n\n      const cacheKey = `${context.type}-${context.id}`;\n      if (lastFetchedRef.current === cacheKey) return;\n\n      lastFetchedRef.current = cacheKey;\n\n      const title = await fetchEntityTitle(context.type, context.id);\n      if (title) {\n        setContext({\n          ...context,\n          title,\n        });\n      }\n    };\n\n    fetchTitle();\n  }, [context, setContext]);\n}\n\n/**\n * Hook to manually set chat context with specific data\n */\nexport function useChatContextSetter() {\n  const { context, setContext } = useChatContext();\n\n  const setProductContext = (id: string, data?: ContextData) => {\n    setContext({\n      type: 'product',\n      id,\n      title: data?.title,\n      data: data?.data,\n    });\n  };\n\n  const setOrderContext = (id: string, data?: ContextData) => {\n    setContext({\n      type: 'order',\n      id,\n      title: data?.title,\n      data: data?.data,\n    });\n  };\n\n  const setPageContext = (id: string, data?: ContextData) => {\n    setContext({\n      type: 'page',\n      id,\n      title: data?.title,\n      data: data?.data,\n    });\n  };\n\n  const setBlogContext = (id: string, data?: ContextData) => {\n    setContext({\n      type: 'blog',\n      id,\n      title: data?.title,\n      data: data?.data,\n    });\n  };\n\n  const setUserContext = (id: string, data?: ContextData) => {\n    setContext({\n      type: 'user',\n      id,\n      title: data?.title,\n      data: data?.data,\n    });\n  };\n\n  const setGeneralContext = () => {\n    setContext({ type: 'general' });\n  };\n\n  return {\n    context,\n    setContext,\n    setProductContext,\n    setOrderContext,\n    setPageContext,\n    setBlogContext,\n    setUserContext,\n    setGeneralContext,\n  };\n}\n\n/**\n * Detect context type and ID from pathname\n */\nfunction detectContextFromPath(\n  pathname: string,\n  params: Record<string, string | string[] | undefined> | null\n): ChatContext {\n  // Admin product pages\n  if (pathname.startsWith('/admin/products/')) {\n    const id = extractId(pathname, '/admin/products/');\n    if (id && id !== 'new') {\n      return { type: 'product', id };\n    }\n    return { type: 'product' };\n  }\n\n  if (pathname === '/admin/products') {\n    return { type: 'product' };\n  }\n\n  // Admin order pages\n  if (pathname.startsWith('/admin/orders/')) {\n    const id = extractId(pathname, '/admin/orders/');\n    if (id) {\n      return { type: 'order', id };\n    }\n    return { type: 'order' };\n  }\n\n  if (pathname === '/admin/orders') {\n    return { type: 'order' };\n  }\n\n  // Admin page pages\n  if (pathname.startsWith('/admin/pages/')) {\n    const id = extractId(pathname, '/admin/pages/');\n    if (id && id !== 'new') {\n      return { type: 'page', id };\n    }\n    return { type: 'page' };\n  }\n\n  if (pathname === '/admin/pages') {\n    return { type: 'page' };\n  }\n\n  // Admin blog pages\n  if (pathname.startsWith('/admin/blog/')) {\n    const id = extractId(pathname, '/admin/blog/');\n    if (id && id !== 'new') {\n      return { type: 'blog', id };\n    }\n    return { type: 'blog' };\n  }\n\n  if (pathname === '/admin/blog') {\n    return { type: 'blog' };\n  }\n\n  // Admin customer pages\n  if (pathname.startsWith('/admin/customers/')) {\n    const id = extractId(pathname, '/admin/customers/');\n    if (id) {\n      return { type: 'user', id };\n    }\n    return { type: 'user' };\n  }\n\n  if (pathname === '/admin/customers') {\n    return { type: 'user' };\n  }\n\n  // Default to general context\n  return { type: 'general' };\n}\n\n/**\n * Extract entity ID from pathname\n */\nfunction extractId(pathname: string, prefix: string): string | null {\n  const remaining = pathname.slice(prefix.length);\n  const parts = remaining.split('/');\n  const id = parts[0];\n\n  // Return null for empty or special paths\n  if (!id || id === 'new' || id === 'edit') {\n    return null;\n  }\n\n  return id;\n}\n"]}