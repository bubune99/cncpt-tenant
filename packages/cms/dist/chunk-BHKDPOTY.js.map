{"version":3,"sources":["/mnt/c/Users/bubun/CascadeProjects/cncpt-tenant/packages/cms/dist/chunk-BHKDPOTY.js","../src/lib/media/types.ts"],"names":[],"mappings":"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","file":"/mnt/c/Users/bubun/CascadeProjects/cncpt-tenant/packages/cms/dist/chunk-BHKDPOTY.js","sourcesContent":[null,"/**\n * Media Library Types\n *\n * Standalone type definitions that don't depend on Prisma client\n * until the database schema is applied and client is regenerated.\n */\n\n// =============================================================================\n// STORAGE PROVIDER (mirrors Prisma enum)\n// =============================================================================\n\nexport type StorageProvider = 'LOCAL' | 'S3' | 'R2' | 'GCS'\n\n// =============================================================================\n// BASE TYPES (mirrors Prisma models)\n// =============================================================================\n\nexport interface MediaBase {\n  id: string\n  filename: string\n  originalName: string\n  mimeType: string\n  size: number\n  url: string\n  width: number | null\n  height: number | null\n  title: string | null\n  alt: string | null\n  caption: string | null\n  description: string | null\n  folderId: string | null\n  provider: StorageProvider\n  bucket: string | null\n  key: string | null\n  uploadedById: string | null\n  deletedAt: Date | null\n  createdAt: Date\n  updatedAt: Date\n}\n\nexport interface MediaFolderBase {\n  id: string\n  name: string\n  slug: string\n  description: string | null\n  color: string | null\n  icon: string | null\n  parentId: string | null\n  path: string\n  depth: number\n  position: number\n  isPublic: boolean\n  createdAt: Date\n  updatedAt: Date\n}\n\nexport interface MediaTagBase {\n  id: string\n  name: string\n  slug: string\n  color: string | null\n  createdAt: Date\n}\n\nexport interface MediaUsageBase {\n  id: string\n  mediaId: string\n  entityType: string\n  entityId: string\n  fieldName: string | null\n  createdAt: Date\n}\n\n// =============================================================================\n// MEDIA TYPES\n// =============================================================================\n\nexport type MediaType = 'image' | 'video' | 'audio' | 'document' | 'other'\n\nexport type ViewMode = 'grid' | 'list'\n\nexport type SortField = 'name' | 'createdAt' | 'size' | 'type'\nexport type SortOrder = 'asc' | 'desc'\n\nexport interface MediaFilters {\n  folderId?: string | null\n  type?: MediaType\n  search?: string\n  tagIds?: string[]\n  includeDeleted?: boolean\n  page?: number\n  limit?: number\n  sortBy?: SortField\n  sortOrder?: SortOrder\n}\n\nexport interface MediaWithRelations extends MediaBase {\n  folder?: MediaFolderBase | null\n  tags?: Array<{ tag: MediaTagBase }>\n  usages?: MediaUsageBase[]\n  uploadedBy?: { id: string; name: string | null; email: string } | null\n  _count?: {\n    usages: number\n  }\n}\n\nexport interface MediaListResponse {\n  media: MediaWithRelations[]\n  total: number\n  page: number\n  limit: number\n  hasMore: boolean\n}\n\nexport interface MediaCreateInput {\n  filename: string\n  originalName: string\n  mimeType: string\n  size: number\n  url: string\n  width?: number\n  height?: number\n  title?: string\n  alt?: string\n  caption?: string\n  description?: string\n  folderId?: string\n  provider?: StorageProvider\n  bucket?: string\n  key?: string\n  uploadedById?: string\n  tagIds?: string[]\n}\n\nexport interface MediaUpdateInput {\n  filename?: string\n  title?: string\n  alt?: string\n  caption?: string\n  description?: string\n  folderId?: string | null\n  tagIds?: string[]\n}\n\n// =============================================================================\n// FOLDER TYPES\n// =============================================================================\n\nexport interface FolderWithRelations extends MediaFolderBase {\n  parent?: MediaFolderBase | null\n  children?: MediaFolderBase[]\n  _count?: {\n    media: number\n    children: number\n  }\n}\n\nexport interface FolderTree extends MediaFolderBase {\n  children: FolderTree[]\n  mediaCount: number\n}\n\nexport interface FolderCreateInput {\n  name: string\n  slug?: string\n  description?: string\n  color?: string\n  icon?: string\n  parentId?: string | null\n  isPublic?: boolean\n}\n\nexport interface FolderUpdateInput {\n  name?: string\n  slug?: string\n  description?: string\n  color?: string\n  icon?: string\n  parentId?: string | null\n  position?: number\n  isPublic?: boolean\n}\n\n// =============================================================================\n// TAG TYPES\n// =============================================================================\n\nexport interface TagWithCount extends MediaTagBase {\n  _count?: {\n    media: number\n  }\n}\n\nexport interface TagCreateInput {\n  name: string\n  slug?: string\n  color?: string\n}\n\nexport interface TagUpdateInput {\n  name?: string\n  slug?: string\n  color?: string\n}\n\n// =============================================================================\n// USAGE TYPES\n// =============================================================================\n\nexport type EntityType = 'product' | 'blog_post' | 'page' | 'category' | 'email_campaign'\n\nexport interface UsageInfo {\n  id: string\n  entityType: EntityType\n  entityId: string\n  entityTitle: string\n  fieldName: string | null\n  url: string\n  createdAt: Date\n}\n\n// =============================================================================\n// UPLOAD TYPES\n// =============================================================================\n\nexport interface UploadOptions {\n  folderId?: string\n  tagIds?: string[]\n  alt?: string\n  caption?: string\n  title?: string\n}\n\nexport interface UploadProgress {\n  id: string\n  filename: string\n  progress: number\n  status: 'pending' | 'uploading' | 'processing' | 'complete' | 'error'\n  error?: string\n  size?: number\n  url?: string\n  media?: MediaWithRelations\n}\n\nexport interface PresignedUrlResponse {\n  uploadUrl: string\n  key: string\n  bucket: string\n  provider: StorageProvider\n  publicUrl: string\n}\n\n// =============================================================================\n// BULK OPERATIONS\n// =============================================================================\n\nexport type BulkOperation = 'delete' | 'move' | 'tag' | 'untag' | 'restore'\n\nexport interface BulkOperationInput {\n  operation: BulkOperation\n  mediaIds: string[]\n  folderId?: string | null\n  tagIds?: string[]\n  hardDelete?: boolean\n}\n\nexport interface BulkOperationResult {\n  success: boolean\n  affected: number\n  errors?: Array<{ id: string; error: string }>\n}\n\n// =============================================================================\n// HELPERS\n// =============================================================================\n\n/**\n * Get media type from MIME type\n */\nexport function getMediaType(mimeType: string): MediaType {\n  if (mimeType.startsWith('image/')) return 'image'\n  if (mimeType.startsWith('video/')) return 'video'\n  if (mimeType.startsWith('audio/')) return 'audio'\n  if (\n    mimeType === 'application/pdf' ||\n    mimeType.includes('document') ||\n    mimeType.includes('spreadsheet') ||\n    mimeType.includes('presentation') ||\n    mimeType === 'text/plain' ||\n    mimeType === 'text/csv' ||\n    mimeType.includes('word') ||\n    mimeType.includes('excel') ||\n    mimeType.includes('powerpoint')\n  ) {\n    return 'document'\n  }\n  return 'other'\n}\n\n/**\n * Get file extension from filename\n */\nexport function getFileExtension(filename: string): string {\n  const parts = filename.split('.')\n  return parts.length > 1 ? parts.pop()!.toLowerCase() : ''\n}\n\n/**\n * Format file size for display\n */\nexport function formatFileSize(bytes: number): string {\n  if (bytes === 0) return '0 Bytes'\n  const k = 1024\n  const sizes = ['Bytes', 'KB', 'MB', 'GB', 'TB']\n  const i = Math.floor(Math.log(bytes) / Math.log(k))\n  return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i]\n}\n\n/**\n * Generate slug from name\n */\nexport function generateSlug(name: string): string {\n  return name\n    .toLowerCase()\n    .replace(/[^a-z0-9]+/g, '-')\n    .replace(/^-+|-+$/g, '')\n}\n\n/**\n * Get MIME type icon name (Lucide icon)\n */\nexport function getMediaTypeIcon(mimeType: string): string {\n  const type = getMediaType(mimeType)\n  switch (type) {\n    case 'image':\n      return 'Image'\n    case 'video':\n      return 'Video'\n    case 'audio':\n      return 'Music'\n    case 'document':\n      if (mimeType === 'application/pdf') return 'FileText'\n      if (mimeType.includes('spreadsheet') || mimeType.includes('excel')) return 'FileSpreadsheet'\n      if (mimeType.includes('presentation') || mimeType.includes('powerpoint')) return 'Presentation'\n      return 'FileText'\n    default:\n      return 'File'\n  }\n}\n\n/**\n * Check if file type is allowed\n */\nexport function isAllowedFileType(mimeType: string, allowedTypes: string[]): boolean {\n  return allowedTypes.some((allowed) => {\n    if (allowed.endsWith('/*')) {\n      const prefix = allowed.slice(0, -2)\n      return mimeType.startsWith(prefix)\n    }\n    return mimeType === allowed\n  })\n}\n\n/**\n * Default allowed file types\n */\nexport const DEFAULT_ALLOWED_TYPES = [\n  'image/*',\n  'video/*',\n  'audio/*',\n  'application/pdf',\n  'application/msword',\n  'application/vnd.openxmlformats-officedocument.wordprocessingml.document',\n  'application/vnd.ms-excel',\n  'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',\n  'application/vnd.ms-powerpoint',\n  'application/vnd.openxmlformats-officedocument.presentationml.presentation',\n  'text/plain',\n  'text/csv',\n]\n\n/**\n * Default max file size (50MB)\n */\nexport const DEFAULT_MAX_FILE_SIZE = 50 * 1024 * 1024\n\n// =============================================================================\n// R2/S3 CORS CONFIGURATION\n// =============================================================================\n\nexport interface CorsRule {\n  AllowedOrigins: string[]\n  AllowedMethods: string[]\n  AllowedHeaders: string[]\n  ExposeHeaders?: string[]\n  MaxAgeSeconds?: number\n}\n\n/**\n * Generate recommended CORS configuration for R2/S3 bucket\n * This configuration is required for browser-based presigned URL uploads\n */\nexport function generateCorsConfig(allowedOrigins: string[]): CorsRule[] {\n  return [\n    {\n      AllowedOrigins: allowedOrigins,\n      AllowedMethods: ['GET', 'PUT', 'HEAD', 'DELETE'],\n      AllowedHeaders: [\n        'Content-Type',\n        'Content-Length',\n        'x-amz-acl',\n        'x-amz-content-sha256',\n        'x-amz-date',\n        'x-amz-user-agent',\n        'authorization',\n      ],\n      ExposeHeaders: ['ETag', 'Content-Length', 'Content-Type'],\n      MaxAgeSeconds: 3600,\n    },\n  ]\n}\n\n/**\n * Get CORS configuration as JSON string for copying to Cloudflare dashboard\n */\nexport function getCorsConfigJson(allowedOrigins: string[]): string {\n  return JSON.stringify(generateCorsConfig(allowedOrigins), null, 2)\n}\n"]}