{"version":3,"sources":["/mnt/c/Users/bubun/CascadeProjects/nextjs-cms/dist/chunk-UOHHIDKD.js","../src/hooks/use-mobile.ts","../src/hooks/usePermissions.ts","../src/exports/hooks.ts"],"names":["useState","useEffect"],"mappings":"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","file":"/mnt/c/Users/bubun/CascadeProjects/nextjs-cms/dist/chunk-UOHHIDKD.js","sourcesContent":[null,"import * as React from \"react\"\r\n\r\nconst MOBILE_BREAKPOINT = 768\r\n\r\nexport function useIsMobile() {\r\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\r\n\r\n  React.useEffect(() => {\r\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\r\n    const onChange = () => {\r\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\r\n    }\r\n    mql.addEventListener(\"change\", onChange)\r\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\r\n    return () => mql.removeEventListener(\"change\", onChange)\r\n  }, [])\r\n\r\n  return !!isMobile\r\n}\r\n","'use client'\n\n/**\n * Client-side permission hook\n * Fetches and caches user permissions for UI rendering\n */\n\nimport { useState, useEffect, useCallback, useMemo } from 'react'\n\ninterface PermissionData {\n  userId: string\n  email: string\n  name: string | null\n  roles: Array<{\n    id: string\n    name: string\n    displayName: string\n  }>\n  permissions: string[]\n  isSuperAdmin: boolean\n}\n\ninterface UsePermissionsReturn {\n  // Data\n  permissions: string[]\n  roles: PermissionData['roles']\n  isSuperAdmin: boolean\n  isLoading: boolean\n  error: Error | null\n\n  // Permission checks\n  can: (permission: string) => boolean\n  canAny: (permissions: string[]) => boolean\n  canAll: (permissions: string[]) => boolean\n  hasRole: (roleName: string) => boolean\n\n  // Refresh\n  refresh: () => Promise<void>\n}\n\n/**\n * Check if a permission matches (including wildcards)\n */\nfunction permissionMatches(userPermission: string, requiredPermission: string): boolean {\n  if (userPermission === requiredPermission) return true\n  if (userPermission === '*') return true\n\n  if (userPermission.endsWith('.*')) {\n    const resource = userPermission.slice(0, -2)\n    return requiredPermission.startsWith(resource + '.')\n  }\n\n  return false\n}\n\nexport function usePermissions(): UsePermissionsReturn {\n  const [data, setData] = useState<PermissionData | null>(null)\n  const [isLoading, setIsLoading] = useState(true)\n  const [error, setError] = useState<Error | null>(null)\n\n  const fetchPermissions = useCallback(async () => {\n    try {\n      setIsLoading(true)\n      setError(null)\n\n      const response = await fetch('/api/auth/permissions')\n\n      if (!response.ok) {\n        if (response.status === 401) {\n          // Not authenticated - that's ok, just no permissions\n          setData(null)\n          return\n        }\n        throw new Error('Failed to fetch permissions')\n      }\n\n      const permData = await response.json()\n      setData(permData)\n    } catch (err) {\n      setError(err instanceof Error ? err : new Error('Unknown error'))\n    } finally {\n      setIsLoading(false)\n    }\n  }, [])\n\n  useEffect(() => {\n    fetchPermissions()\n  }, [fetchPermissions])\n\n  // Permission check functions\n  const can = useCallback(\n    (permission: string): boolean => {\n      if (!data) return false\n      if (data.isSuperAdmin) return true\n\n      return data.permissions.some((p) => permissionMatches(p, permission))\n    },\n    [data]\n  )\n\n  const canAny = useCallback(\n    (permissions: string[]): boolean => {\n      return permissions.some((p) => can(p))\n    },\n    [can]\n  )\n\n  const canAll = useCallback(\n    (permissions: string[]): boolean => {\n      return permissions.every((p) => can(p))\n    },\n    [can]\n  )\n\n  const hasRole = useCallback(\n    (roleName: string): boolean => {\n      if (!data) return false\n      return data.roles.some((r) => r.name === roleName)\n    },\n    [data]\n  )\n\n  return useMemo(\n    () => ({\n      permissions: data?.permissions ?? [],\n      roles: data?.roles ?? [],\n      isSuperAdmin: data?.isSuperAdmin ?? false,\n      isLoading,\n      error,\n      can,\n      canAny,\n      canAll,\n      hasRole,\n      refresh: fetchPermissions,\n    }),\n    [data, isLoading, error, can, canAny, canAll, hasRole, fetchPermissions]\n  )\n}\n\n/**\n * Permission gate component\n * Renders children only if user has the required permission\n */\ninterface PermissionGateProps {\n  permission?: string\n  permissions?: string[]\n  requireAll?: boolean\n  fallback?: React.ReactNode\n  children: React.ReactNode\n}\n\nexport function PermissionGate({\n  permission,\n  permissions,\n  requireAll = false,\n  fallback = null,\n  children,\n}: PermissionGateProps): React.ReactNode {\n  const { can, canAny, canAll, isLoading } = usePermissions()\n\n  if (isLoading) {\n    return fallback\n  }\n\n  // Single permission check\n  if (permission) {\n    return can(permission) ? children : fallback\n  }\n\n  // Multiple permissions check\n  if (permissions && permissions.length > 0) {\n    const hasAccess = requireAll\n      ? canAll(permissions)\n      : canAny(permissions)\n\n    return hasAccess ? children : fallback\n  }\n\n  // No permission specified - render children\n  return children\n}\n\nexport default usePermissions\n","/**\r\n * Hooks exports\r\n */\r\n\r\nexport { useAuth } from '../hooks/use-auth'\r\nexport { useIsMobile } from '../hooks/use-mobile'\r\nexport { useMediaUpload } from '../hooks/use-media-upload'\r\nexport { usePermissions } from '../hooks/usePermissions'\r\n\r\n// Re-export debounce hooks from usehooks-ts\r\nexport { useDebounceValue, useDebounceCallback } from 'usehooks-ts'\r\n"]}